<UserControl
    x:Class="YoutubeDownloader.Features.VideoSummary.VideoSummaryView"
    xmlns="https://github.com/avaloniaui"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:videoSummary="clr-namespace:YoutubeDownloader.Features.VideoSummary"
    xmlns:ggml="clr-namespace:Whisper.net.Ggml;assembly=Whisper.net"
    Width="600"
    x:DataType="videoSummary:VideoSummaryViewModel">
    <Grid RowDefinitions="Auto,Auto,*,Auto">
        <!-- Title -->
        <TextBlock
            Grid.Row="0"
            Margin="16"
            FontSize="19"
            FontWeight="Light"
            Text="AI ì˜ìƒ ìš”ì•½" />

        <!-- Controls -->
        <Border
            Grid.Row="1"
            Padding="16,8"
            BorderBrush="{DynamicResource MaterialDividerBrush}"
            BorderThickness="0,1,0,0">
            <StackPanel Orientation="Vertical" Spacing="8">
                <!-- Video Title -->
                <TextBlock
                    FontWeight="SemiBold"
                    Text="{Binding VideoTitle}"
                    TextTrimming="CharacterEllipsis" />

                <!-- Model Selection -->
                <StackPanel Orientation="Horizontal" Spacing="8">
                    <TextBlock VerticalAlignment="Center" Text="ëª¨ë¸ ì„ íƒ:" />
                    <ComboBox
                        Width="120"
                        ItemsSource="{Binding AvailableModels}"
                        SelectedItem="{Binding SelectedModel}" />
                    <Button
                        Command="{Binding DownloadModelCommand}"
                        Content="ëª¨ë¸ ë‹¤ìš´ë¡œë“œ"
                        IsEnabled="{Binding !IsDownloadingModel}"
                        IsVisible="{Binding !IsModelReady}" />
                    <TextBlock
                        VerticalAlignment="Center"
                        Foreground="Green"
                        IsVisible="{Binding IsModelReady}"
                        Text="âœ“ ì¤€ë¹„ë¨" />
                </StackPanel>

                <!-- Status -->
                <TextBlock
                    FontStyle="Italic"
                    Foreground="{DynamicResource MaterialBodyBrush}"
                    Text="{Binding StatusMessage}" />

                <!-- Action Buttons -->
                <StackPanel Orientation="Horizontal" Spacing="8">
                    <Button
                        Command="{Binding StartProcessingCommand}"
                        Content="ìš”ì•½ ì‹œìž‘"
                        IsEnabled="{Binding !IsProcessing}"
                        Theme="{DynamicResource MaterialFlatButton}" />
                    <Button
                        Command="{Binding CancelProcessingCommand}"
                        Content="ì·¨ì†Œ"
                        IsVisible="{Binding IsProcessing}"
                        Theme="{DynamicResource MaterialOutlineButton}" />
                    <ProgressBar
                        Width="100"
                        IsIndeterminate="True"
                        IsVisible="{Binding IsProcessing}" />
                </StackPanel>
            </StackPanel>
        </Border>

        <!-- Results -->
        <Border
            Grid.Row="2"
            Padding="16"
            BorderBrush="{DynamicResource MaterialDividerBrush}"
            BorderThickness="0,1,0,0">
            <ScrollViewer HorizontalScrollBarVisibility="Disabled" VerticalScrollBarVisibility="Auto">
                <StackPanel Orientation="Vertical" Spacing="16">
                    <!-- Summary -->
                    <StackPanel IsVisible="{Binding SummaryText.Length}" Spacing="4">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <TextBlock FontWeight="SemiBold" Text="ðŸ“ ìš”ì•½" />
                            <Button
                                Command="{Binding SaveSummaryCommand}"
                                Content="ì €ìž¥"
                                FontSize="11"
                                Padding="4,2"
                                Theme="{DynamicResource MaterialFlatButton}" />
                            <Button
                                Command="{Binding CopySummaryCommand}"
                                Content="ë³µì‚¬"
                                FontSize="11"
                                Padding="4,2"
                                Theme="{DynamicResource MaterialFlatButton}" />
                        </StackPanel>
                        <TextBlock
                            Text="{Binding SummaryText}"
                            TextWrapping="Wrap" />
                    </StackPanel>

                    <!-- Transcript -->
                    <StackPanel IsVisible="{Binding TranscriptText.Length}" Spacing="4">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <TextBlock FontWeight="SemiBold" Text="ðŸ“„ ì „ì²´ í…ìŠ¤íŠ¸ (ìžë§‰)" />
                            <Button
                                Command="{Binding SaveTranscriptCommand}"
                                Content="ì €ìž¥"
                                FontSize="11"
                                Padding="4,2"
                                Theme="{DynamicResource MaterialFlatButton}" />
                            <Button
                                Command="{Binding CopyTranscriptCommand}"
                                Content="ë³µì‚¬"
                                FontSize="11"
                                Padding="4,2"
                                Theme="{DynamicResource MaterialFlatButton}" />
                        </StackPanel>
                        <TextBlock
                            MaxHeight="200"
                            Text="{Binding TranscriptText}"
                            TextWrapping="Wrap" />
                    </StackPanel>
                </StackPanel>
            </ScrollViewer>
        </Border>

        <!-- Close Button -->
        <Button
            Grid.Row="3"
            Margin="16"
            HorizontalAlignment="Stretch"
            Command="{Binding CloseDialogCommand}"
            Content="ë‹«ê¸°"
            IsCancel="True"
            IsDefault="True"
            Theme="{DynamicResource MaterialOutlineButton}" />
    </Grid>
</UserControl>
